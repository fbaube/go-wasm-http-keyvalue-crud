<!doctype html>
<html lang=en dir=ltr class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated=false>
  <head>
    <meta charset=UTF-8>
    <title data-rh=true>Walkthrough: A wasmCloud CRUD application in Go | wasmCloud</title>
    <meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0">
  </head>
  <body>
    <pre>https://wasmcloud.com/blog/2025-01-23-walkthrough-a-wasmclod-crud-application-in-go/</pre>
    <div class=postItem_zDj7><div class=text_ym4G><h2 class=title_YmVR><a href=/blog/2025-01-23-walkthrough-a-wasmclod-crud-application-in-go/>Walkthru of a wasmCloud CRUD app in Go</a></h2><div class=meta_lUqw><div class="margin-top--md margin-bottom--sm row authors_nnZ3"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href=https://github.com/ericgregory target=_blank rel="noopener noreferrer" class=avatar__photo-link></a><div class="avatar__intro authorDetails_uciD"><div class=avatar__name><a href=https://github.com/ericgregory target=_blank rel="noopener noreferrer"><span class="authorName_r1JK avatar__name">Eric Gregory</span></a></div><small class="authorTitle_ym37 avatar__subtitle" title="wasmCloud Maintainer">wasmCloud Maintainer</small></div></div></div></div><span class=separator_bSeg></span><span class=info_iPyz><div class="container_mt6G margin-vert--md"><time datetime=2025-01-27T00:00:00.000Z>January 27, 2025</time> · <!-- -->14 min read</div></span></div><div><div class=row><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#before-we-begin class="table-of-contents__link toc-highlight">Before we begin</a><li><a href=#run-the-example class="table-of-contents__link toc-highlight">Run the example</a><li><a href=#exploring-the-component-project class="table-of-contents__link toc-highlight">Exploring the component project</a><li><a href=#understanding-the-interfaces class="table-of-contents__link toc-highlight">Understanding the interfaces</a><li><a href=#exploring-the-code class="table-of-contents__link toc-highlight">Exploring the code</a><li><a href=#prepare-for-deployment class="table-of-contents__link toc-highlight">Prepare for deployment</a><li><a href=#launch-and-run-manually class="table-of-contents__link toc-highlight">Launch and run (manually)</a><li><a href=#next-steps class="table-of-contents__link toc-highlight">Next steps</a></ul></div></div><div class="col col--9">
<p>Exploring a web application that performs simple <a href=https://en.wikipedia.org/wiki/Create,_read,_update_and_delete target=_blank rel="noopener noreferrer">CRUD operations</a> (Create, Read, Update, Destroy) is a great way to understand new application paradigms.</p>
<p>In this walkthrough, we'll unpack a simple CRUD application in Go, compile the code to a <a href=/docs/concepts/components/>WebAssembly component</a>, and run it on wasmCloud using swappable, vendorless <a href=/docs/concepts/capabilities/>capabilities</a> for HTTP service and key-value storage.</p>
<p>By the end, you'll understand how the pieces of a wasmCloud application fit together, and how to use the <code>wasi:http</code> and <code>wasi:keyvalue</code> interfaces in your Go-based wasmCloud projects.</p>
<p>Let's get started!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=before-we-begin>Before we begin<a href=#before-we-begin class=hash-link aria-label="Direct link to Before we begin" title="Direct link to Before we begin">​</a></h2>
<p>We'll need a few tools for this walkthrough:</p>
<ul>
<li><a href=https://wasmcloud.com/docs/installation target=_blank rel="noopener noreferrer"><strong>wasmCloud Shell (<code>wash</code>)</strong></a> provides a command-line interface for wasmCloud, helping you build and deploy components and run a local wasmCloud environment.</li>
<li>The <a href=https://go.dev/doc/install target=_blank rel="noopener noreferrer"><strong>Go (1.23+) toolchain</strong></a> and <a href=https://tinygo.org/getting-started/install/ target=_blank rel="noopener noreferrer"><strong>TinyGo</strong></a> let us compile Go code to a WebAssembly component. The TinyGo project moves quickly, so always use the latest version.</li>
<li><a href=https://github.com/bytecodealliance/wasm-tools#installation target=_blank rel="noopener noreferrer"><strong><code>wasm-tools</code></strong></a> is a utility that helps generate bindings between language-agnostic <a href=/docs/concepts/interfaces/>interfaces</a> and Go.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=run-the-example>Run the example<a href=#run-the-example class=hash-link aria-label="Direct link to Run the example" title="Direct link to Run the example">​</a></h2>
<p>To download the example, you can clone the <a href=https://github.com/wasmcloud/go target=_blank rel="noopener noreferrer">wasmCloud/go repository</a>:</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>shell</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-shell><span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>git</span><span style=color:#032F62;--shiki-dark:#9ECBFF> clone</span><span style=color:#032F62;--shiki-dark:#9ECBFF> https://github.com/wasmCloud/go.git</span></span>
<span class=line></span></code></pre></div></div>
<p>Change directory to <code>examples/component/http-keyvalue-crud</code>:</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>shell</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-shell><span class=line><span style=color:#005CC5;--shiki-dark:#79B8FF>cd</span><span style=color:#032F62;--shiki-dark:#9ECBFF> examples/component/http-keyvalue-crud</span></span>
<span class=line></span></code></pre></div></div>
<p>We'll start by running the example and seeing what it does—then we'll take a look under the hood and see how it all works.</p>
<p>From the project directory, run:</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>shell</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-shell><span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>wash</span><span style=color:#032F62;--shiki-dark:#9ECBFF> dev</span></span>
<span class=line></span></code></pre></div></div>
<p>This will start a dev loop that automatically builds and deploys your app (in a local wasmCloud environment) and continuously watches for changes.</p>
<p>In a new terminal tab, you can view your wasmCloud apps and check status:</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>shell</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-shell><span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>wash</span><span style=color:#032F62;--shiki-dark:#9ECBFF> app</span><span style=color:#032F62;--shiki-dark:#9ECBFF> list</span></span>
<span class=line></span></code></pre></div></div>
<p>Once the app status for <code>http-keyvalue-crud</code> is <code>Deployed</code>, we can test a POST against our app with <code>curl</code>:</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>shell</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-shell><span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>curl</span><span style=color:#005CC5;--shiki-dark:#79B8FF> -X</span><span style=color:#032F62;--shiki-dark:#9ECBFF> POST</span><span style=color:#032F62;--shiki-dark:#9ECBFF> localhost:8000/crud/mario</span><span style=color:#005CC5;--shiki-dark:#79B8FF> -d</span><span style=color:#032F62;--shiki-dark:#9ECBFF> '{"itsa": "me", "woo": "hoo"}'</span></span>
<span class=line></span></code></pre></div></div>
<p>We should get the result:</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>text</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-text><span class=line><span>{"message":"Set mario", "value":"{"itsa": "me", "woo": "hoo"}"}</span></span>
<span class=line><span></span></span></code></pre></div></div>
<p>We can test a GET and DELETE as well:</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>shell</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-shell><span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>curl</span><span style=color:#032F62;--shiki-dark:#9ECBFF> localhost:8000/crud/mario</span></span>
<span class=line></span></code></pre></div></div>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>text</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-text><span class=line><span>{"message":"Got mario", "value":"{"itsa": "me", "woo": "hoo"}"}</span></span>
<span class=line><span></span></span></code></pre></div></div>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>shell</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-shell><span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>curl</span><span style=color:#005CC5;--shiki-dark:#79B8FF> -X</span><span style=color:#032F62;--shiki-dark:#9ECBFF> DELETE</span><span style=color:#032F62;--shiki-dark:#9ECBFF> localhost:8000/crud/mario</span></span>
<span class=line></span></code></pre></div></div>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>text</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-text><span class=line><span>{"message":"Deleted mario"}</span></span>
<span class=line><span></span></span></code></pre></div></div>
<p>You can press Ctrl+C in your first terminal tab to stop the dev loop.</p>
<p>Now let's take a step back and see how the pieces of this application fit together.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=exploring-the-component-project>Exploring the component project<a href=#exploring-the-component-project class=hash-link aria-label="Direct link to Exploring the component project" title="Direct link to Exploring the component project">​</a></h2>
<p>In wasmCloud, a <a href=/docs/concepts/components/><strong>component</strong></a> is a WebAssembly component dedicated to an application's creative logic. Typically, we will simply refer to this as a "component." The code in this directory is for a Go application that compiles to a component.</p>
<p>Here we have the standard <code>go.mod</code> file for a Go project and a <code>.go</code> file for the application. We also have a few more pieces that make up a wasmCloud project:</p>
<ul>
<li><code>/build</code>: Target directory for compiled <code>.wasm</code> binaries</li>
<li><code>/gen</code>: Target directory for Go bindings of <a href=https://wasmcloud.com/docs/concepts/interfaces target=_blank rel="noopener noreferrer">interfaces</a></li>
<li><code>/wit</code>: Directory for WebAssembly Interface Type (WIT) packages that define interfaces</li>
<li><code>bindings.wadge.go</code>: Automatically generated test bindings</li>
<li><code>wadm.yaml</code>: Declarative application manifest</li>
<li><code>wasmcloud.lock</code>: Automatically generated lockfile for WIT packages</li>
<li><code>wasmcloud.toml</code>: Configuration file for a wasmCloud application</li>
</ul>
<p>Let's take a tour of the major pieces of the project.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=understanding-the-interfaces>Understanding the interfaces<a href=#understanding-the-interfaces class=hash-link aria-label="Direct link to Understanding the interfaces" title="Direct link to Understanding the interfaces">​</a></h2>
<p>We will interact with the <code>httpserver</code> and <code>keyvalue</code> capabilities via language-agnostic interfaces defined in the <strong>WebAssembly Interface Type (WIT)</strong> interface description language. These are standard interfaces belonging to the <a href=https://wasi.dev/ target=_blank rel="noopener noreferrer">WebAssembly System Interface (WASI)</a>.</p>
<p>Take a look at the contents of <code>wit/world.wit</code>:</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>wit</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-wit><span class=line><span style=color:#D73A49;--shiki-dark:#F97583>package</span><span style=color:#032F62;--shiki-dark:#9ECBFF> wasmcloud:http-keyvalue-crud</span><span style=color:#24292E;--shiki-dark:#E1E4E8>;</span></span>
<span class=line></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>world</span><span style=color:#6F42C1;--shiki-dark:#B392F0> component</span><span style=color:#24292E;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>  include</span><span style=color:#032F62;--shiki-dark:#9ECBFF> wasmcloud:component-go/imports@0.1.0</span><span style=color:#24292E;--shiki-dark:#E1E4E8>;</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>  import</span><span style=color:#032F62;--shiki-dark:#9ECBFF> wasi:logging/logging@0.1.0-draft</span><span style=color:#24292E;--shiki-dark:#E1E4E8>;</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>  import</span><span style=color:#032F62;--shiki-dark:#9ECBFF> wasi:keyvalue/store@0.2.0-draft</span><span style=color:#24292E;--shiki-dark:#E1E4E8>; </span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>  export</span><span style=color:#032F62;--shiki-dark:#9ECBFF> wasi:http/incoming-handler@0.2.0</span><span style=color:#24292E;--shiki-dark:#E1E4E8>;</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span></code></pre></div></div>
<p>This <strong>world</strong> file specifies the interfaces that our code will utilize. In this project, we're using:</p>
<ul>
<li><code>wasi:http/incoming-handler@0.2.0</code></li>
<li><code>wasi:keyvalue/store@0.2.0-draft</code></li>
<li><code>wasi:logging/logging@0.1.0-draft</code></li>
</ul>
<p>Specifically, we're <strong>importing</strong> <code>keyvalue/store</code> and <code>logging</code>, while we're <strong>exporting</strong> <code>http/incoming-handler</code>. That means the component will rely on another entity to provide storage and logging functionality, while exposing functions that can be invoked by an HTTP server over the <code>http/incoming-handler</code> interface.</p>
<p>We're also including <code>wasmcloud:component-go/imports@0.1.0</code> to make use of the <a href=https://github.com/wasmCloud/go/tree/main/component target=_blank rel="noopener noreferrer">Go Component SDK</a>—an optional framework that provides a more idiomatic Go development experience for WASI interfaces like the ones in this project.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=exploring-the-code>Exploring the code<a href=#exploring-the-code class=hash-link aria-label="Direct link to Exploring the code" title="Direct link to Exploring the code">​</a></h2>
<p>Now that our dependencies are defined, let's take a look at the code in <code>main.go</code>. We'll start with the first line:</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>go</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-go><span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>//go:generate go run go.bytecodealliance.org/cmd/wit-bindgen-go generate --world component --out gen ./wit</span></span>
<span class=line></span></code></pre></div></div>
<p>This line specifies how the <code>wash</code> builder should generate Go bindings for our WIT interfaces. When we build the application with the <code>wash build</code> command, the builder will use these instructions to run the <code>wit-bindgen-go</code> tool and generate bindings between the functions defined in the WIT dependencies and Go.</p>
<p>Let's try it out. In the root of the project directory:</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>shell</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-shell><span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>wash</span><span style=color:#032F62;--shiki-dark:#9ECBFF> build</span></span>
<span class=line></span></code></pre></div></div>
<p>This will create a a compiled <code>.wasm</code> binary in the <code>build</code> directory. It will also populate the <code>gen</code> directory with bindings. You can explore those binding files to get a sense of how to use the interfaces, and IDEs with autocompletion can help you make use of them as well.</p>
<p>Now let's take a look at the imports.</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>go</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-go><span class=line><span style=color:#D73A49;--shiki-dark:#F97583>import</span><span style=color:#24292E;--shiki-dark:#E1E4E8> (</span></span>
<span class=line><span style=color:#032F62;--shiki-dark:#9ECBFF>	"</span><span style=color:#6F42C1;--shiki-dark:#B392F0>encoding/json</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"</span></span>
<span class=line><span style=color:#032F62;--shiki-dark:#9ECBFF>	"</span><span style=color:#6F42C1;--shiki-dark:#B392F0>fmt</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"</span></span>
<span class=line><span style=color:#032F62;--shiki-dark:#9ECBFF>	"</span><span style=color:#6F42C1;--shiki-dark:#B392F0>io</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"</span></span>
<span class=line><span style=color:#032F62;--shiki-dark:#9ECBFF>	"</span><span style=color:#6F42C1;--shiki-dark:#B392F0>net/http</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// A lightweight, high performance HTTP request router</span></span>
<span class=line><span style=color:#032F62;--shiki-dark:#9ECBFF>	"</span><span style=color:#6F42C1;--shiki-dark:#B392F0>github.com/julienschmidt/httprouter</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// For the keyvalue capability, we're using bindings for the wasi:keyvalue/store interface.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	store </span><span style=color:#032F62;--shiki-dark:#9ECBFF>"</span><span style=color:#6F42C1;--shiki-dark:#B392F0>github.com/wasmCloud/go/examples/component/http-keyvalue-crud/gen/wasi/keyvalue/store</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// The cm module provides types and functions for interacting with the WebAssembly Component Model.</span></span>
<span class=line><span style=color:#032F62;--shiki-dark:#9ECBFF>	"</span><span style=color:#6F42C1;--shiki-dark:#B392F0>go.bytecodealliance.org/cm</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// The wasmCloud wasihttp module enables us to write more idiomatic Go when using wasi:http.</span></span>
<span class=line><span style=color:#032F62;--shiki-dark:#9ECBFF>	"</span><span style=color:#6F42C1;--shiki-dark:#B392F0>go.wasmcloud.dev/component/net/wasihttp</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>)</span></span>
<span class=line></span></code></pre></div></div>
<p>We have several packages worth noting here:</p>
<ul>
<li>Core Go packages like <code>encoding/json</code>, <code>fmt</code>, and <code>io</code>. We can use these like in any other Go app and compile to a component.</li>
<li>A third-party HTTP router. We can use this in our component, too.</li>
<li>The Go bindings we generated for the <code>wasi:keyvalue/store</code> interface. These are referenced at <code>&lt;project name>/gen/</code>.</li>
<li>The <code>go.bytecodealliance.org/cm</code> package for building Go applications that interact with the <a href=https://wasmcloud.com/docs/concepts/components#open-standards target=_blank rel="noopener noreferrer">WebAssembly Component Model</a>.</li>
<li>The optional wasmCloud <code>wasihttp</code> package for writing more idiomatic Go when using <code>wasi:http</code>.</li>
</ul>
<p>Next in <code>main.go</code>, we define a couple of types that we'll use to validate JSON later on.</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>go</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-go><span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>// Types for JSON validation.</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>type</span><span style=color:#6F42C1;--shiki-dark:#B392F0> CheckRequest</span><span style=color:#D73A49;--shiki-dark:#F97583> struct</span><span style=color:#24292E;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	Value </span><span style=color:#D73A49;--shiki-dark:#F97583>string</span><span style=color:#032F62;--shiki-dark:#9ECBFF> `json:"value"`</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>type</span><span style=color:#6F42C1;--shiki-dark:#B392F0> CheckResponse</span><span style=color:#D73A49;--shiki-dark:#F97583> struct</span><span style=color:#24292E;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	Valid   </span><span style=color:#D73A49;--shiki-dark:#F97583>bool</span><span style=color:#032F62;--shiki-dark:#9ECBFF>   `json:"valid"`</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	Length  </span><span style=color:#D73A49;--shiki-dark:#F97583>int</span><span style=color:#032F62;--shiki-dark:#9ECBFF>    `json:"length,omitempty"`</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	Message </span><span style=color:#D73A49;--shiki-dark:#F97583>string</span><span style=color:#032F62;--shiki-dark:#9ECBFF> `json:"message,omitempty"`</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span></code></pre></div></div>
<p>Then we reach the <code>init()</code> function:</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>go</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-go><span class=line><span style=color:#D73A49;--shiki-dark:#F97583>func</span><span style=color:#6F42C1;--shiki-dark:#B392F0> init</span><span style=color:#24292E;--shiki-dark:#E1E4E8>() {</span></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Establishes the routes and methods for our key-value operations.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	router </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> httprouter.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>New</span><span style=color:#24292E;--shiki-dark:#E1E4E8>()</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	router.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>GET</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"/"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, indexHandler)</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	router.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>POST</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"/crud/:key"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, postHandler)</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	router.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>GET</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"/crud/:key"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, getHandler)</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	router.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>DELETE</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"/crud/:key"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, deleteHandler)</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	wasihttp.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Handle</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(router)</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span></code></pre></div></div>
<p>This program doesn't run like a CLI, so the <code>main</code> function is empty (and tucked away down at the end of the file). Instead, we establish our routes and methods in the <code>init()</code> function and call the relevant function when an HTTP request is received.</p>
<p>The simplest handler function is <code>indexHandler</code>—it simply provides instructions (in a JSON envelope) on how to use the application. Users will make a GET, POST, or DELETE request to the <code>/crud/</code> endpoint with a key provided as a parameter and a JSON payload for POST operations.</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>go</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-go><span class=line><span style=color:#D73A49;--shiki-dark:#F97583>func</span><span style=color:#6F42C1;--shiki-dark:#B392F0> indexHandler</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#E36209;--shiki-dark:#FFAB70>w</span><span style=color:#6F42C1;--shiki-dark:#B392F0> http</span><span style=color:#24292E;--shiki-dark:#E1E4E8>.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>ResponseWriter</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, </span><span style=color:#E36209;--shiki-dark:#FFAB70>r</span><span style=color:#D73A49;--shiki-dark:#F97583> *</span><span style=color:#6F42C1;--shiki-dark:#B392F0>http</span><span style=color:#24292E;--shiki-dark:#E1E4E8>.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Request</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, </span><span style=color:#E36209;--shiki-dark:#FFAB70>_</span><span style=color:#6F42C1;--shiki-dark:#B392F0> httprouter</span><span style=color:#24292E;--shiki-dark:#E1E4E8>.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Params</span><span style=color:#24292E;--shiki-dark:#E1E4E8>) {</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	fmt.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Fprintln</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(w, </span><span style=color:#032F62;--shiki-dark:#9ECBFF>`{"message":"GET, POST, or DELETE to /crud/&lt;key> (with JSON payload for POSTs)"}`</span><span style=color:#24292E;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span></code></pre></div></div>
<p>Note the idiomatic use of <code>fmt.Fprintln</code>, with <code>w</code> for the HTTP <code>ResponseWriter</code>. Though we're using <code>wasi:http</code> under the hood, this is a Go-standard approach to HTTP, made possible by the <code>go.wasmcloud.dev/component/net/wasihttp</code> package.</p>
<p>Now let's take a look at the handler for POST operations.</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>go</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-go><span class=line><span style=color:#D73A49;--shiki-dark:#F97583>func</span><span style=color:#6F42C1;--shiki-dark:#B392F0> postHandler</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#E36209;--shiki-dark:#FFAB70>w</span><span style=color:#6F42C1;--shiki-dark:#B392F0> http</span><span style=color:#24292E;--shiki-dark:#E1E4E8>.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>ResponseWriter</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, </span><span style=color:#E36209;--shiki-dark:#FFAB70>r</span><span style=color:#D73A49;--shiki-dark:#F97583> *</span><span style=color:#6F42C1;--shiki-dark:#B392F0>http</span><span style=color:#24292E;--shiki-dark:#E1E4E8>.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Request</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, </span><span style=color:#E36209;--shiki-dark:#FFAB70>ps</span><span style=color:#6F42C1;--shiki-dark:#B392F0> httprouter</span><span style=color:#24292E;--shiki-dark:#E1E4E8>.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Params</span><span style=color:#24292E;--shiki-dark:#E1E4E8>) {</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Assigns the "key" paramater to the "key" variable.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	key </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> ps.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>ByName</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"key"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Checks the request for a valid JSON body and assigns it to the value variable.</span></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// The user will set the value via JSON payload:</span></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// curl -X POST 'localhost:8000/crud/key' -d '{"foo": "bar", "woo": "hoo"}'</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>	var</span><span style=color:#24292E;--shiki-dark:#E1E4E8> req </span><span style=color:#6F42C1;--shiki-dark:#B392F0>CheckRequest</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>	defer</span><span style=color:#24292E;--shiki-dark:#E1E4E8> r.Body.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Close</span><span style=color:#24292E;--shiki-dark:#E1E4E8>()</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	value, err </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> io.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>ReadAll</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(r.Body)</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>	if</span><span style=color:#24292E;--shiki-dark:#E1E4E8> err </span><span style=color:#D73A49;--shiki-dark:#F97583>!=</span><span style=color:#005CC5;--shiki-dark:#79B8FF> nil</span><span style=color:#24292E;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>		errResponseJSON</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(w, http.StatusBadRequest, err.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Error</span><span style=color:#24292E;--shiki-dark:#E1E4E8>())</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>		return</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	}</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>	if</span><span style=color:#24292E;--shiki-dark:#E1E4E8> err </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> json.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Unmarshal</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(value, </span><span style=color:#D73A49;--shiki-dark:#F97583>&</span><span style=color:#24292E;--shiki-dark:#E1E4E8>req); err </span><span style=color:#D73A49;--shiki-dark:#F97583>!=</span><span style=color:#005CC5;--shiki-dark:#79B8FF> nil</span><span style=color:#24292E;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>		errResponseJSON</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(w, http.StatusBadRequest, fmt.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Sprintf</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"error with json input: </span><span style=color:#005CC5;--shiki-dark:#79B8FF>%s</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, err.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Error</span><span style=color:#24292E;--shiki-dark:#E1E4E8>()))</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>		return</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	}</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Opens the keyvalue bucket.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	kvStore </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> store.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Open</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"default"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>	if</span><span style=color:#24292E;--shiki-dark:#E1E4E8> err </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> kvStore.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Err</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(); err </span><span style=color:#D73A49;--shiki-dark:#F97583>!=</span><span style=color:#005CC5;--shiki-dark:#79B8FF> nil</span><span style=color:#24292E;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>		errResponseJSON</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(w, http.StatusInternalServerError, err.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>String</span><span style=color:#24292E;--shiki-dark:#E1E4E8>())</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>		return</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	}</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Converts the value to a byte array.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	valueBytes </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> []</span><span style=color:#D73A49;--shiki-dark:#F97583>byte</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(value)</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Converts the byte array to the Component Model's cm.List type.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	valueList </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> cm.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>ToList</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(valueBytes)</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Sets the value for the key in the current bucket and handles any errors.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	kvSet </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> store.Bucket.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Set</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#D73A49;--shiki-dark:#F97583>*</span><span style=color:#24292E;--shiki-dark:#E1E4E8>kvStore.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>OK</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(), key, valueList)</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>	if</span><span style=color:#24292E;--shiki-dark:#E1E4E8> kvSet.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>IsErr</span><span style=color:#24292E;--shiki-dark:#E1E4E8>() {</span></span>
<span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>		errResponseJSON</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(w, http.StatusBadRequest, kvSet.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Err</span><span style=color:#24292E;--shiki-dark:#E1E4E8>().</span><span style=color:#6F42C1;--shiki-dark:#B392F0>String</span><span style=color:#24292E;--shiki-dark:#E1E4E8>())</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>		return</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	}</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Confirms set, returning key and value in JSON body.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	kvSetMessage </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> fmt.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Sprintf</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"Set </span><span style=color:#005CC5;--shiki-dark:#79B8FF>%s</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, key)</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	kvSetResponse </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> fmt.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Sprintf</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>`{"message":"</span><span style=color:#005CC5;--shiki-dark:#79B8FF>%s</span><span style=color:#032F62;--shiki-dark:#9ECBFF>", "value":"</span><span style=color:#005CC5;--shiki-dark:#79B8FF>%s</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"}`</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, kvSetMessage, value)</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	fmt.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Fprintln</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(w, kvSetResponse)</span></span>
<span class=line></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span></code></pre></div></div>
<p>In this function, we...</p>
<ul>
<li><strong>Grab the key parameter</strong> and assign it to a <code>key</code> variable.</li>
<li><strong>Look for a JSON body</strong> in the request and assign it to a <code>value</code> variable.</li>
<li><strong>Open a key-value bucket</strong>. Note that this operation is agnostic to the key-value store in question—the component simply opens an abstract bucket, and the store on the other side could be Redis, NATS, Vault, or something else entirely. The same will go for the rest of our key-value operations.</li>
<li><strong>Convert the value to a list of bytes</strong> so we can pass it around in the Component Model's language-agnostic, implementation-agnostic way.</li>
<li><strong>Set the value</strong> for the specified key with <code>store.Bucket.Set</code>.</li>
<li><strong>Return a confirmation message</strong> with the key and value.</li>
</ul>
<p>The <code>set</code> operation covers the <strong>Create</strong> and <strong>Update</strong> pieces of CRUD. So now we need handlers for <code>get</code> and <code>delete</code> operations. These functions look pretty similar to the last one:</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>go</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-go><span class=line><span style=color:#D73A49;--shiki-dark:#F97583>func</span><span style=color:#6F42C1;--shiki-dark:#B392F0> getHandler</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#E36209;--shiki-dark:#FFAB70>w</span><span style=color:#6F42C1;--shiki-dark:#B392F0> http</span><span style=color:#24292E;--shiki-dark:#E1E4E8>.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>ResponseWriter</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, </span><span style=color:#E36209;--shiki-dark:#FFAB70>r</span><span style=color:#D73A49;--shiki-dark:#F97583> *</span><span style=color:#6F42C1;--shiki-dark:#B392F0>http</span><span style=color:#24292E;--shiki-dark:#E1E4E8>.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Request</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, </span><span style=color:#E36209;--shiki-dark:#FFAB70>ps</span><span style=color:#6F42C1;--shiki-dark:#B392F0> httprouter</span><span style=color:#24292E;--shiki-dark:#E1E4E8>.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Params</span><span style=color:#24292E;--shiki-dark:#E1E4E8>) {</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Assigns the "key" paramater to the "key" variable.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	key </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> ps.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>ByName</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"key"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Opens the keyvalue bucket.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	kvStore </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> store.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Open</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"default"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>	if</span><span style=color:#24292E;--shiki-dark:#E1E4E8> err </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> kvStore.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Err</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(); err </span><span style=color:#D73A49;--shiki-dark:#F97583>!=</span><span style=color:#005CC5;--shiki-dark:#79B8FF> nil</span><span style=color:#24292E;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>		errResponseJSON</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(w, http.StatusInternalServerError, err.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>String</span><span style=color:#24292E;--shiki-dark:#E1E4E8>())</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>		return</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	}</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Gets the value for the defined key.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	kvGet, kvGetErr, kvGetIsErr </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> store.Bucket.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Get</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#D73A49;--shiki-dark:#F97583>*</span><span style=color:#24292E;--shiki-dark:#E1E4E8>kvStore.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>OK</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(), key).</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Result</span><span style=color:#24292E;--shiki-dark:#E1E4E8>()</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Returns and reports that key does not exist if no value is found.</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>	if</span><span style=color:#24292E;--shiki-dark:#E1E4E8> kvGet.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Value</span><span style=color:#24292E;--shiki-dark:#E1E4E8>().</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Len</span><span style=color:#24292E;--shiki-dark:#E1E4E8>() </span><span style=color:#D73A49;--shiki-dark:#F97583>==</span><span style=color:#005CC5;--shiki-dark:#79B8FF> 0</span><span style=color:#24292E;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>		errResponseJSON</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(w, http.StatusBadRequest, fmt.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Sprintf</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"</span><span style=color:#005CC5;--shiki-dark:#79B8FF>%s</span><span style=color:#032F62;--shiki-dark:#9ECBFF> does not exist"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, key))</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>		return</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	}</span></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Handles get errors other than non-existent key</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>	if</span><span style=color:#24292E;--shiki-dark:#E1E4E8> kvGetIsErr {</span></span>
<span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>		errResponseJSON</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(w, http.StatusBadRequest, kvGetErr.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>String</span><span style=color:#24292E;--shiki-dark:#E1E4E8>())</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>		return</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	}</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Uses cm.LiftString to convert the byte value into a string, taking the data and len as arguments.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	kvGetJSON </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> cm.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>LiftString</span><span style=color:#24292E;--shiki-dark:#E1E4E8>[</span><span style=color:#D73A49;--shiki-dark:#F97583>string</span><span style=color:#24292E;--shiki-dark:#E1E4E8>](kvGet.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Value</span><span style=color:#24292E;--shiki-dark:#E1E4E8>().</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Data</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(), kvGet.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Value</span><span style=color:#24292E;--shiki-dark:#E1E4E8>().</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Len</span><span style=color:#24292E;--shiki-dark:#E1E4E8>())</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Returns key and value in JSON body.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	kvGetMessage </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> fmt.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Sprintf</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"Got </span><span style=color:#005CC5;--shiki-dark:#79B8FF>%s</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, key)</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	kvGetResponse </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> fmt.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Sprintf</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>`{"message":"</span><span style=color:#005CC5;--shiki-dark:#79B8FF>%s</span><span style=color:#032F62;--shiki-dark:#9ECBFF>", "value":"</span><span style=color:#005CC5;--shiki-dark:#79B8FF>%s</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"}`</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, kvGetMessage, kvGetJSON)</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	fmt.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Fprintln</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(w, kvGetResponse)</span></span>
<span class=line></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span></code></pre></div></div>
<p>The <code>get</code> operation looks a lot like the <code>set</code>, except that the translation between string and list-of-bytes happens in reverse—in this case, we get a byte value from the bucket and then convert that value into a string that we can return with <code>fmt.Sprintf</code>.</p>
<p>Now our <strong>Read</strong> is handled. All that's left is to <strong>Destroy</strong>.</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>go</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-go><span class=line><span style=color:#D73A49;--shiki-dark:#F97583>func</span><span style=color:#6F42C1;--shiki-dark:#B392F0> deleteHandler</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#E36209;--shiki-dark:#FFAB70>w</span><span style=color:#6F42C1;--shiki-dark:#B392F0> http</span><span style=color:#24292E;--shiki-dark:#E1E4E8>.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>ResponseWriter</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, </span><span style=color:#E36209;--shiki-dark:#FFAB70>r</span><span style=color:#D73A49;--shiki-dark:#F97583> *</span><span style=color:#6F42C1;--shiki-dark:#B392F0>http</span><span style=color:#24292E;--shiki-dark:#E1E4E8>.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Request</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, </span><span style=color:#E36209;--shiki-dark:#FFAB70>ps</span><span style=color:#6F42C1;--shiki-dark:#B392F0> httprouter</span><span style=color:#24292E;--shiki-dark:#E1E4E8>.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Params</span><span style=color:#24292E;--shiki-dark:#E1E4E8>) {</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Assigns the "key" paramater to the "key" variable.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	key </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> ps.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>ByName</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"key"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Opens the keyvalue bucket.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	kvStore </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> store.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Open</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"default"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>	if</span><span style=color:#24292E;--shiki-dark:#E1E4E8> err </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> kvStore.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Err</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(); err </span><span style=color:#D73A49;--shiki-dark:#F97583>!=</span><span style=color:#005CC5;--shiki-dark:#79B8FF> nil</span><span style=color:#24292E;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>		errResponseJSON</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(w, http.StatusInternalServerError, err.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>String</span><span style=color:#24292E;--shiki-dark:#E1E4E8>())</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>		return</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	}</span></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Returns and reports that key does not exist if no value is found.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	kvGet, _, _ </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> store.Bucket.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Get</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#D73A49;--shiki-dark:#F97583>*</span><span style=color:#24292E;--shiki-dark:#E1E4E8>kvStore.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>OK</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(), key).</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Result</span><span style=color:#24292E;--shiki-dark:#E1E4E8>()</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>	if</span><span style=color:#24292E;--shiki-dark:#E1E4E8> kvGet.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Value</span><span style=color:#24292E;--shiki-dark:#E1E4E8>().</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Len</span><span style=color:#24292E;--shiki-dark:#E1E4E8>() </span><span style=color:#D73A49;--shiki-dark:#F97583>==</span><span style=color:#005CC5;--shiki-dark:#79B8FF> 0</span><span style=color:#24292E;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>		errResponseJSON</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(w, http.StatusBadRequest, fmt.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Sprintf</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"</span><span style=color:#005CC5;--shiki-dark:#79B8FF>%s</span><span style=color:#032F62;--shiki-dark:#9ECBFF> does not exist"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, key))</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>		return</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	}</span></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Deletes the entry for the provided key.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	kvDel </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> store.Bucket.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Delete</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#D73A49;--shiki-dark:#F97583>*</span><span style=color:#24292E;--shiki-dark:#E1E4E8>kvStore.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>OK</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(), key)</span></span>
<span class=line></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>	if</span><span style=color:#24292E;--shiki-dark:#E1E4E8> kvDel.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>IsErr</span><span style=color:#24292E;--shiki-dark:#E1E4E8>() {</span></span>
<span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>		errResponseJSON</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(w, http.StatusBadRequest, kvDel.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Err</span><span style=color:#24292E;--shiki-dark:#E1E4E8>().</span><span style=color:#6F42C1;--shiki-dark:#B392F0>String</span><span style=color:#24292E;--shiki-dark:#E1E4E8>())</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>		return</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	}</span></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>	// Confirms delete in JSON body.</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	kvDelMessage </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> fmt.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Sprintf</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"Deleted </span><span style=color:#005CC5;--shiki-dark:#79B8FF>%s</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, key)</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	kvDelResponse </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> fmt.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Sprintf</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>`{"message":"</span><span style=color:#005CC5;--shiki-dark:#79B8FF>%s</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"}`</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, kvDelMessage)</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	fmt.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Fprintln</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(w, kvDelResponse)</span></span>
<span class=line></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span></code></pre></div></div>
<p>This looks similar to the above functions, with one exception—we perform a cheeky <code>store.Bucket.Get</code> <em>before</em> the <code>store.Bucket.Delete</code> so we can handle the condition where the key doesn't exist. <code>wasi:keyvalue/store0.2.0-draft</code> doesn't treat finding a null value for a given key as an error, so instead we get the value and check to see whether its length is zero. With the check out of the way, we simply delete and return a confirmation.</p>
<p>The only pieces left in our component code are a brief function for JSON validation handling and our empty <code>main</code> function.</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>go</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-go><span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>// JSON validation handling.</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>func</span><span style=color:#6F42C1;--shiki-dark:#B392F0> errResponseJSON</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#E36209;--shiki-dark:#FFAB70>w</span><span style=color:#6F42C1;--shiki-dark:#B392F0> http</span><span style=color:#24292E;--shiki-dark:#E1E4E8>.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>ResponseWriter</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, </span><span style=color:#E36209;--shiki-dark:#FFAB70>code</span><span style=color:#D73A49;--shiki-dark:#F97583> int</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, </span><span style=color:#E36209;--shiki-dark:#FFAB70>message</span><span style=color:#D73A49;--shiki-dark:#F97583> string</span><span style=color:#24292E;--shiki-dark:#E1E4E8>) {</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	msg, _ </span><span style=color:#D73A49;--shiki-dark:#F97583>:=</span><span style=color:#24292E;--shiki-dark:#E1E4E8> json.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Marshal</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#6F42C1;--shiki-dark:#B392F0>CheckResponse</span><span style=color:#24292E;--shiki-dark:#E1E4E8>{Valid: </span><span style=color:#005CC5;--shiki-dark:#79B8FF>false</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, Message: message})</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	http.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Error</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(w, </span><span style=color:#D73A49;--shiki-dark:#F97583>string</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(msg), code)</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>	w.</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Header</span><span style=color:#24292E;--shiki-dark:#E1E4E8>().</span><span style=color:#6F42C1;--shiki-dark:#B392F0>Set</span><span style=color:#24292E;--shiki-dark:#E1E4E8>(</span><span style=color:#032F62;--shiki-dark:#9ECBFF>"Content-Type"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>, </span><span style=color:#032F62;--shiki-dark:#9ECBFF>"application/json"</span><span style=color:#24292E;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>// Since we don't run this program like a CLI, the `main` function is empty. Instead,</span></span>
<span class=line><span style=color:#6A737D;--shiki-dark:#6A737D>// we call handler functions when an HTTP request is received.</span></span>
<span class=line><span style=color:#D73A49;--shiki-dark:#F97583>func</span><span style=color:#6F42C1;--shiki-dark:#B392F0> main</span><span style=color:#24292E;--shiki-dark:#E1E4E8>() {}</span></span>
<span class=line></span></code></pre></div></div>
<p>We've finished walking through the code, and we've already built the <code>.wasm</code> binary with <code>wash build</code>—now it's time to look at the application manifest.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=prepare-for-deployment>Prepare for deployment<a href=#prepare-for-deployment class=hash-link aria-label="Direct link to Prepare for deployment" title="Direct link to Prepare for deployment">​</a></h2>
<p>The declarative application manifest in <code>wadm.yaml</code> defines the desired state for our application when it is running in a wasmCloud environment. Manifests use the Open Application Model (OAM) standard and will look familiar if you've used Kubernetes. The manifest included with the <code>http-keyvalue-crud</code> example looks like this:</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>yaml</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-yaml><span class=line><span style=color:#22863A;--shiki-dark:#85E89D>apiVersion</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>core.oam.dev/v1beta1</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>kind</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>Application</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>metadata</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>  name</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>"http-keyvalue-crud"</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>  annotations</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>    description</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>"HTTP and keyvalue CRUD example"</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>    wasmcloud.dev/authors</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>wasmCloud team</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>    wasmcloud.dev/source-url</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>https://github.com/wasmCloud/go/blob/main/examples/components/http-keyvalue-crud/wadm.yaml</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>    wasmcloud.dev/readme-md-url</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>https://github.com/wasmCloud/go/blob/main/examples/components/http-keyvalue-crud/README.md</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>    wasmcloud.dev/homepage</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>https://github.com/wasmCloud/go/blob/main/examples/components/http-keyvalue-crud</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>    wasmcloud.dev/categories</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#D73A49;--shiki-dark:#F97583>|</span></span>
<span class=line><span style=color:#032F62;--shiki-dark:#9ECBFF>      http,outgoing-http,http-server,tinygo,golang,example</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>spec</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>  components</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>  - </span><span style=color:#22863A;--shiki-dark:#85E89D>name</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>keyvalue-nats</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>    type</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>capability</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>    properties</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>      image</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>ghcr.io/wasmcloud/keyvalue-nats:0.3.1</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>    traits</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: []</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>  - </span><span style=color:#22863A;--shiki-dark:#85E89D>name</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>http-server</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>    type</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>capability</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>    properties</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>      image</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>ghcr.io/wasmcloud/http-server:0.24.0</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>    traits</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>    - </span><span style=color:#22863A;--shiki-dark:#85E89D>type</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>link</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>      properties</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>        namespace</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>wasi</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>        package</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>http</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>        interfaces</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>        - </span><span style=color:#032F62;--shiki-dark:#9ECBFF>incoming-handler</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>        source</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>          config</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>          - </span><span style=color:#22863A;--shiki-dark:#85E89D>name</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>wasi-http-config</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>            properties</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>              address</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>127.0.0.1:8000</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>        target</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>          name</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>crud</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>  - </span><span style=color:#22863A;--shiki-dark:#85E89D>name</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>crud</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>    type</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>component</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>    properties</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>      image</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>file://./build/http-keyvalue-crud_s.wasm</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>      id</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>crud</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>    traits</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>    - </span><span style=color:#22863A;--shiki-dark:#85E89D>type</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>spreadscaler</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>      properties</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>        instances</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#005CC5;--shiki-dark:#79B8FF>100</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>    - </span><span style=color:#22863A;--shiki-dark:#85E89D>type</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>link</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>      properties</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>        namespace</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>wasi</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>        package</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>keyvalue</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>        interfaces</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>        - </span><span style=color:#032F62;--shiki-dark:#9ECBFF>store</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>        target</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>          name</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>keyvalue-nats</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>          config</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292E;--shiki-dark:#E1E4E8>          - </span><span style=color:#22863A;--shiki-dark:#85E89D>name</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>wasi-keyvalue-config</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>            properties</span><span style=color:#24292E;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>              bucket</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>wasmcloud</span></span>
<span class=line><span style=color:#22863A;--shiki-dark:#85E89D>              enable_bucket_auto_create</span><span style=color:#24292E;--shiki-dark:#E1E4E8>: </span><span style=color:#032F62;--shiki-dark:#9ECBFF>'true'</span></span>
<span class=line></span>
<span class=line></span></code></pre></div></div>
<p>Let's walk through the manifest.</p>
<ul>
<li>The <code>metadata</code> fields provide a name, description, and other optional metadata for the application.</li>
<li>The <code>components</code> fields under <code>spec</code> describe the different pieces of our application—not <em>just</em> WebAssembly components, but also capability providers. This application consists of three pieces:<!-- -->
<ul>
<li>The <code>keyvalue-nats</code> capability provider, which mediates between the WebAssembly component we built from <code>main.go</code> and the actual key-value store we're using—in this case, the storage built into the <a href=/docs/ecosystem/nats/>NATS connective layer</a> that is already part of your wasmCloud environment. This provider is fetched as an <a href=/docs/concepts/packaging/>OCI artifact</a>.</li>
<li>The <code>http-server</code> capability provider, which handles HTTP service, also as an OCI artifact.</li>
<li>The <code>crud</code> component that we just built, served up straight from the local binary.</li>
</ul>
</li>
<li>Under the components, we define configuration and links that connect the entities. Links are defined under the <code>source</code> (or importer) on the interface in question. (Learn more about linking on the <a href=/docs/concepts/linking-components/linking-at-runtime/>Linking at runtime</a> overview.)</li>
</ul>
<p>When we wrote the code for our WebAssembly component, we didn't worry about how key-value and HTTP services would be rendered. We treated them as abstractions, and now at deployment, we've defined the specific providers that will fulfill those abstractions with concrete implementations.</p>
<p>It's important to emphasize that different providers could just as easily do the same jobs. The same component we wrote could perform CRUD operations against <em>any</em> key-value store as long as a provider exists for it. (And if a provider doesn't exist yet, you can always <a href=/docs/developer/providers/>create one</a>.)</p>
<p>It's <em>also</em> important to note that we didn't have to think about the manifest when we used <code>wash dev</code>. Because components define their interface requirements (and the functions they expose to other entities) in the <code>.wasm</code> binaries themselves, it's possible to reason programmatically about manifests and generate them automatically, which is exactly what <code>wash dev</code> does.</p>
<p>When the <code>wash dev</code> process sees a well-known interface in a binary, it fulfills the requirement with an appropriate provider, which is why we never had to think about which key-value store we were using when we first ran this application.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=launch-and-run-manually>Launch and run (manually)<a href=#launch-and-run-manually class=hash-link aria-label="Direct link to Launch and run (manually)" title="Direct link to Launch and run (manually)">​</a></h2>
<p>The <code>wash dev</code> subcommand launched a local wasmCloud environment and deployed the application automatically. This time, we'll perform the same steps manually. Start a local wasmCloud environment (using the <code>-d</code>/<code>--detached</code> flag to run in the background):</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>shell</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-shell><span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>wash</span><span style=color:#032F62;--shiki-dark:#9ECBFF> up</span><span style=color:#005CC5;--shiki-dark:#79B8FF> -d</span><span style=color:#24292E;--shiki-dark:#E1E4E8> </span></span>
<span class=line></span></code></pre></div></div>
<p>Now you can launch the application:</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>shell</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-shell><span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>wash</span><span style=color:#032F62;--shiki-dark:#9ECBFF> app</span><span style=color:#032F62;--shiki-dark:#9ECBFF> deploy</span><span style=color:#032F62;--shiki-dark:#9ECBFF> wadm.yaml</span></span>
<span class=line></span></code></pre></div></div>
<p>Once again, we can check the app's status with <code>wash app list</code>.</p>
<p>If we want to update our application (and we're not using the dev loop), we can <code>wash build</code> and <code>wash app deploy wadm.yaml</code> again.</p>
<p>Once you're finished with the example, you can delete the application from your wasmCloud environment by referring either to the application name (<code>http-keyvalue-crud</code>) or deployment manifest you used to launch it:</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>shell</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-shell><span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>wash</span><span style=color:#032F62;--shiki-dark:#9ECBFF> app</span><span style=color:#032F62;--shiki-dark:#9ECBFF> delete</span><span style=color:#032F62;--shiki-dark:#9ECBFF> wadm.yaml</span></span>
<span class=line></span></code></pre></div></div>
<p>Shut down your local wasmCloud environment:</p>
<div class=CodeBlock_JubQ><div class=header_nRGG><div>shell</div><button type=button aria-label="Copy code to clipboard" title=Copy class="clean-btn button_VwMK"><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div><div class=content_riH0><pre class="pre_PmPj shiki"><code class=language-shell><span class=line><span style=color:#6F42C1;--shiki-dark:#B392F0>wash</span><span style=color:#032F62;--shiki-dark:#9ECBFF> down</span></span>
<span class=line></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=next-steps>Next steps<a href=#next-steps class=hash-link aria-label="Direct link to Next steps" title="Direct link to Next steps">​</a></h2>
<p>In this walkthrough, we took a look at a simple CRUD application in Go that uses WASI interfaces including <code>wasi:http</code> and <code>wasi:keyvalue</code>.</p>
<p>With these fundamentals in place, good next steps might be working through the <a href=/docs/developer/components/>Component Developer Guide</a> or <a href=/docs/capabilities/>exploring other wasmCloud capabilities</a>.</p>
</body>
</html>
